@tailwind base;
@tailwind components;
@tailwind utilities;

/* ========================================
   MOBILE RESPONSIVENESS FIXES
   ======================================== */

/* Prevent horizontal overflow on mobile */
* {
  box-sizing: border-box;
}

html,
body {
  overflow-x: hidden;
  width: 100%;
  position: relative;
}

/* Mobile viewport fixes */
@supports (-webkit-touch-callout: none) {

  /* iOS Safari specific fixes */
  body {
    min-height: -webkit-fill-available;
  }
}

/* Safe area insets for notched devices */
.safe-area-bottom {
  padding-bottom: env(safe-area-inset-bottom);
}

/* Code block container */
.prose pre,
div:has(> pre[class*="language-"]) {
  max-width: 100% !important;
  overflow-x: auto !important;
  -webkit-overflow-scrolling: touch;
}

/* Ensure code block wrapper doesn't overflow */
.my-4.rounded-lg.overflow-hidden {
  max-width: 100% !important;
  overflow: hidden !important;
  margin-bottom: 1rem !important;
}

/* Remove excessive spacing after code blocks */
.my-4 {
  margin-bottom: 1rem !important;
}

/* ========================================
   MOBILE-SPECIFIC FIXES
   ======================================== */

@media (max-width: 768px) {

  /* Prevent any horizontal scroll */
  body {
    overflow-x: hidden !important;
    max-width: 100vw !important;
  }

  /* Force code blocks to scroll horizontally */
  pre[class*="language-"],
  .prose pre,
  pre code {
    max-width: calc(100vw - 2rem) !important;
    overflow-x: auto !important;
    white-space: pre !important;
    word-wrap: normal !important;
    word-break: normal !important;
    overflow-y: auto !important;
    /* Allow vertical scroll if needed */
  }

  /* Message container width constraints */
  .prose {
    max-width: 100% !important;
    overflow-wrap: break-word;
  }

  /* Ensure message content doesn't overflow */
  .group.flex.gap-4 {
    max-width: 100vw;
    overflow-x: hidden;
  }

  /* Prevent textarea from causing overflow */
  textarea {
    max-width: 100%;
    touch-action: manipulation;
  }

  /* Fixed positioning for input container */
  .px-3.py-3.sm\:p-4.border-t {
    position: fixed !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 50 !important;
    background-color: var(--color-bkg, #ffffff) !important;
    padding-bottom: calc(env(safe-area-inset-bottom) + 0.75rem) !important;
    border-top: 1px solid var(--color-border, #e5e7eb) !important;
  }

  /* Add padding to chat container to prevent overlap with fixed input */
  .flex-1.overflow-y-auto.overscroll-contain {
    padding-bottom: 140px !important;
  }

  /* Adjust for keyboard visibility */
  .flex.flex-col.h-full {
    height: 100vh !important;
    height: 100dvh !important;
  }
}

/* ========================================
   SCROLLBAR STYLING
   ======================================== */

/* Custom scrollbar for code blocks */
pre[class*="language-"]::-webkit-scrollbar {
  height: 8px;
  background: rgba(0, 0, 0, 0.1);
}

pre[class*="language-"]::-webkit-scrollbar-thumb {
  background: rgba(0, 0, 0, 0.3);
  border-radius: 4px;
}

pre[class*="language-"]::-webkit-scrollbar-thumb:hover {
  background: rgba(0, 0, 0, 0.5);
}

/* Dark mode scrollbar */
.dark pre[class*="language-"]::-webkit-scrollbar,
.oled pre[class*="language-"]::-webkit-scrollbar {
  background: rgba(255, 255, 255, 0.1);
}

.dark pre[class*="language-"]::-webkit-scrollbar-thumb,
.oled pre[class*="language-"]::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.3);
}

.dark pre[class*="language-"]::-webkit-scrollbar-thumb:hover,
.oled pre[class*="language-"]::-webkit-scrollbar-thumb:hover {
  background: rgba(255, 255, 255, 0.5);
}

/* ========================================
   UTILITY CLASSES
   ======================================== */

.overflow-x-auto {
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

/* Prevent text selection on buttons during touch */
@media (max-width: 768px) {
  button {
    -webkit-tap-highlight-color: transparent;
    user-select: none;
  }
}